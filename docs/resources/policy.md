---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "tdh_policy Resource - tdh"
subcategory: ""
description: |-
  Represents a policy on TDH.
---

# tdh_policy (Resource)

Represents a policy on TDH.

## Example Usage

```terraform
data "tdh_service_roles" "pg" { # to view what all role can be used
  type = "POSTGRES"
}

data "tdh_cluster_metadata" "pg" {  # to view which database/schema/table to use in resource regex
  id = "CLUSTER_ID"
}

resource "tdh_policy" "sample" {
  name         = "tf-pg-policy"
  description  = "to allow login and create DB"
  service_type = "POSTGRES"
  permission_specs = [
    {
      resource    = "cluster:${data.tdh_cluster_metadata.pg.name}"
      role        = "login" # use any value from tdh_service_roles.all.list[*].name
      permissions = ["login"]  # use the same value from tdh_service_roles.all.list[*].name
    },
    {
      resource    = "cluster:${data.tdh_cluster_metadata.pg.name}/database:broadcom" # use any value from tdh_cluster_metadata.pg.databases[*].name
      role        = "create" # this role is database specific; same can be known by the structure of permissionId of service role
      permissions = ["create"]
    },
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Name of the policy
- `permission_specs` (Attributes Set) Permissions to enforce on service resources. Only required for policies other than `NETWORK` type. (see [below for nested schema](#nestedatt--permission_specs))
- `service_type` (String) Type of TDH service to managed. Supported values: `POSTGRES`, `MYSQL`, `RABBITMQ`, `REDIS`.

### Optional

- `description` (String) Description of the policy

### Read-Only

- `id` (String) Auto-generated ID of the policy after creation, and can be used to import it from TDH to terraform state.
- `resource_ids` (Set of String) IDs of service resources/instances being managed by the policy.

<a id="nestedatt--permission_specs"></a>
### Nested Schema for `permission_specs`

Required:

- `permissions` (Set of String) Name of the permission, usually same as role name. Please make use of datasource `tdh_service_roles` to get the relevant values.
- `resource` (String) Name of the cluster/instance. Please make use of datasource `tdh_clusters` to get the names & . Format of this field is: `cluster:<NAME>[/database:<DB_NAME>[/schema:<SCHEMA>[/table:<TABLE>]]]`.
- `role` (String) Name of the role, it will vary on service type. Please make use of datasource `tdh_service_roles` to get the relevant values by a service type, `POSTGRES` for example.

## Import

Import is supported using the following syntax:

```shell
# Policy can be imported by specifying the UUID.
terraform import tdh_policy.sample d3c49288-7b17-4e78-a6af-257b49e34e53
```
